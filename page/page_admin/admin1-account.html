<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/assets/CSS/admin/admin1.css" />
  <link rel="stylesheet" href="styles.css">
</head>
<body>
   <div class="admin-manager">
      <div class="sidebar">
      <div class="sidebar-menu">
        <h3 class="brand">
          <span class="ti-unlink"></span> 
          <span>Dashboard</span>
        </h3>
        <span class="ti-menu-alt"></span>
      </div>
      <div class="sidebar-task">
        <ul>
          <li>
            <a href="../page_admin/admin1.html">
              <span class="ti-home"></span>
              <i class="fas fa-home"></i>
              <span>Trang chủ</span>
            </a>
          </li>
          <li>
            <a href="../page_admin/admin1-tasks.html">
              <span class="ti-agenda"></span>
              <i class="fas fa-tasks"></i>
              <span>Quản lý sản phẩm</span>
            </a>
          </li>
          <li>
            <a href="/page/receipt.html">
              <span class="ti-clipboard"></span>
              <i class="fas fa-receipt"></i>
              <span>Hóa đơn</span>
            </a>
          </li>
         
          <li>
            <a href="">
              <span class="ti-book"></span>
              <i class="fas fa-address-book"></i>
              <span>Liên hệ</span>
            </a>
          </li>
          <li>
            <a href="../page_admin/admin1-account.html">
              <span class="ti-settings"></span>
              <i class="fas fa-user"></i>
              <span>Quản lý tài khoản</span>
            </a>
          </li>
        </ul>  
      </div>
   </div>
   <div class="main-content">
    <h2>Quản lý khách hàng</h2>
    <div class="product-management">
      <div class="product-table">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Tên khách hàng</th>
              <th>Hình ảnh</th>
              <th>Mật khẩu</th>
              <th>Hành động</th>
            </tr>
          </thead>
          <tbody id="product-list">
            <!-- Các sản phẩm sẽ được thêm động vào đây -->
             <td>3238</td>
             <td>Nguyễn Minh Tài</td>
             <td><img src="../page_admin/img-1.jpg" alt=""></td>
             <td>tgbpu90er90un</td>
             <td>
              <button onclick="editProduct(14368)">Sửa</button>
              <button onclick="confirmDelete(14368)">Xóa</button>
             </td>
          </tbody>
          <tbody id="product-list">
            <!-- Các sản phẩm sẽ được thêm động vào đây -->
             <td>3368</td>
             <td>Nguyễn Khiêm Huy</td>
             <td><img src="../page_admin/img-1.jpg" alt=""></td>
             <td>03t4h97834h78</td>
             <td>
              <button onclick="editProduct(14368)">Sửa</button>
              <button onclick="confirmDelete(14368)">Xóa</button>
             </td>
          </tbody>
          <tbody id="product-list">
            <!-- Các sản phẩm sẽ được thêm động vào đây -->
             <td>4168</td>
             <td>Nguyễn Huy Toàn/td>
             <td><img src="../page_admin/img-2.jpg" alt=""></td>
             <td>etgojertg890er</td>
             <td>
              <button onclick="editProduct(14368)">Sửa</button>
              <button onclick="confirmDelete(14368)">Xóa</button>
             </td>
          </tbody>
          <tbody id="product-list">
            <!-- Các sản phẩm sẽ được thêm động vào đây -->
             <td>4368</td>
             <td>Nguyễn Khoa Tuấn</td>
             <td><img src="../page_admin/img-3.jpg" alt=""></td>
             <td>5ftnerf7t8b87e</td>
             <td>
              <button onclick="editProduct(14368)">Sửa</button>
              <button onclick="confirmDelete(14368)">Xóa</button>
             </td>
          </tbody>
            <tbody id="product-list">
              <!-- Các sản phẩm sẽ được thêm động vào đây -->
              <td>5678</td>
              <td>Phạm Thị Phương Thư</td>
              <td><img src="../page_admin/img-2.jpg" alt=""></td>
              <td>53g53489nh</td>
              <td>
                <button onclick="editProduct(14368)">Sửa</button>
                <button onclick="confirmDelete(14368)">Xóa</button>
              </td>
            </tbody>
        </table>
      </div>
      <div class="add-button"><button id="add-product-btn">Thêm Khách hàng</button></div>
    </div>
    
    <!-- Modal Thêm/Sửa Sản phẩm -->
    <div id="product-modal" class="modal hidden">
      <div class="modal-content">
        <span class="close-btn">&times;</span>
        <h3 id="modal-title">Thêm Khách hàng</h3>
        <form id="product-form">
          <input type="hidden" id="product-id" />
          <label for="product-name">Tên Khách hàng:</label>
          <input type="text" id="product-name" required />
          <label for="product-image">Hình ảnh:</label>
          <input type="file" id="product-image" />
          <label for="product-price">Mật khẩu:</label>
          <input type="number" id="product-price" required />
          <button type="submit">Lưu</button>
        </form>
      </div>
    </div>
    
    <!-- Modal Xác nhận Xóa -->
    <div id="delete-modal" class="modal hidden">
      <div class="modal-content">
        <p>Bạn có chắc chắn muốn xóa khách hàng này?</p>
        <button id="confirm-delete">Xóa</button>
        <button id="cancel-delete">Hủy</button>
      </div>
    </div>    
   </div>
   </div>

   <!-- JavaScript -->
   <script>
    const productList = [];
    let editingProduct = null;

    // Mở modal
    const openModal = (isEdit = false, product = {}) => {
      const modal = document.getElementById('product-modal');
      document.getElementById('modal-title').textContent = isEdit ? 'Sửa khách hàng' : 'Thêm khách hàng';
      document.getElementById('product-id').value = isEdit ? product.id : '';
      document.getElementById('product-name').value = isEdit ? product.name : '';
      document.getElementById('product-price').value = isEdit ? product.price : '';
      modal.classList.remove('hidden');
    };

    // Đóng modal
    const closeModal = () => {
      document.getElementById('product-modal').classList.add('hidden');
    };

    // Thêm sản phẩm vào danh sách
    const addProductToList = (product) => {
      const tbody = document.getElementById('product-list');
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${product.id}</td>
        <td>${product.name}</td>
        <td><img src="${product.image}" alt="Hình ảnh" width="50"></td>
        <td>${product.price}</td>
        <td>
          <button onclick="editProduct(${product.id})">Sửa</button>
          <button onclick="confirmDelete(${product.id})">Xóa</button>
        </td>
      `;
      tbody.appendChild(row);
    };

    // Thêm sản phẩm
    document.getElementById('product-form').addEventListener('submit', (e) => {
      e.preventDefault();
      const id = document.getElementById('product-id').value || Date.now();
      const name = document.getElementById('product-name').value;
      const price = document.getElementById('product-price').value;
      const image = document.getElementById('product-image').files[0]
        ? URL.createObjectURL(document.getElementById('product-image').files[0])
        : '';

      const product = { id, name, price, image };
      if (editingProduct) {
        // Sửa sản phẩm
        const index = productList.findIndex((p) => p.id == id);
        productList[index] = product;
        document.getElementById('product-list').innerHTML = '';
        productList.forEach(addProductToList);
        editingProduct = null;
      } else {
        // Thêm sản phẩm mới
        productList.push(product);
        addProductToList(product);
      }

      closeModal();
    });

    // Sửa sản phẩm
    const editProduct = (id) => {
      const product = productList.find((p) => p.id == id);
      editingProduct = product;
      openModal(true, product);
    };

    // Xóa sản phẩm
    let productToDelete = null;
    const confirmDelete = (id) => {
      productToDelete = id;
      document.getElementById('delete-modal').classList.remove('hidden');
    };

    document.getElementById('confirm-delete').addEventListener('click', () => {
      productList.splice(
        productList.findIndex((p) => p.id == productToDelete),
        1
      );
      document.getElementById('product-list').innerHTML = '';
      productList.forEach(addProductToList);
      document.getElementById('delete-modal').classList.add('hidden');
    });

    document.getElementById('cancel-delete').addEventListener('click', () => {
      productToDelete = null;
      document.getElementById('delete-modal').classList.add('hidden');
    });

    // Đóng modal
    document.querySelectorAll('.close-btn').forEach((btn) =>
      btn.addEventListener('click', closeModal)
    );

    document.getElementById('add-product-btn').addEventListener('click', () => openModal(false));

   </script>
</body>
</html>
